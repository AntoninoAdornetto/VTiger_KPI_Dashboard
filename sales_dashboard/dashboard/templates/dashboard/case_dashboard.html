{% extends 'dashboard/base.html' %}

{% block content %}
            
<form method="GET" action=".">
    <label for="group_dropdown">Group:</label>
    <select name="group_dropdown" id = "group_dropdown">
        <option selected>--Select Group--</option>
        {% for group  in case_groups %}
        <option value="{{ group.assigned_groupname }}">{{ group.assigned_groupname }}</option>
        {% endfor %} 
    </select>
    </br>
    <label for="date_start">Modified Time Start:</label>
    <input type="date" name="date_start" id="date_start" min="2020-01-01" max="2030-01-01">
    </br>
    <button type="submit">Submit</button>
</form>

<br>
<p>Group: {{ date_group_dict.group }} </p>
<p>All Open Cases: {{ all_open_cases.open_cases }}</p>
<button onclick="showHideCaseTable('all')">Show/Hide Case Table</button>
<div id = "case_table_all">
    <table class = "scrollable_table">
        <tbody>
            <tr>
                <th>Number</th>
                <th>Group</th>
                <th>Assigned To</th>
                <th>Title</th>
                <th>Status</th>
                <th>Created (UTC)</th>
                <th>Modified (UTC)</th>
                <th>Resolved (UTC)</th>
                <th>Time Spent</th>
            </tr>
            {% for case in all_open_cases.full_cases %}
                <tr>
                    <td>{{ case.case_no }}</td>
                    <td>{{ case.assigned_groupname }}</td>
                    <td>{{ case.assigned_username }}</td>
                    <td>{{ case.title }}</td>
                    <td>{{ case.casestatus }}</td>
                    <td>{{ case.createdtime }}</td>
                    <td>{{ case.modifiedtime }}</td>
                    <td>{{ case.case_resolved }}</td>
                    <td>{{ case.time_spent_hr }}</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>


<hr>
<br>

<p>TODAY</p>
<p>{{ date_group_dict.today }}</p>
<br>
<section class="points">
            <div class = "score_box">
                <span class ="score_name">MODIFIED</span> </br> <span class="score_num">{{ case_stats_dict.modified }}</span>
            </div>
            <div class = "score_box">
                <span class ="score_name">CREATED</span> </br> <span class="score_num">{{ case_stats_dict.opened }}</span>
            </div>
            <div class = "score_box">
                <span class ="score_name">RESOLVED</span> </br> <span class="score_num">{{ case_stats_dict.closed }}</span>
            </div>
            <div class = "score_box">
                <span class ="score_name">KILL RATE</span> </br> <span class="score_num">{{ case_stats_dict.kill_rate }}%</span>
            </div>
            <div>
                {% if sorted_user_closed|length > 0 %}
                    <table>
                        <tbody>
                            <tr>
                                <th>USER</th>
                                <th>CLOSED CASES</th>
                            </tr>
                            {% for score  in sorted_user_closed %}
                                <tr>
                                    <th>{{ score.0 }} </th>
                                    <th>{{ score.1 }} </th>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                {% endif %}
            </div>
</section>


<button onclick="showHideCaseTable('day')">Show/Hide Case Table</button>
<div id = "case_table_day">
    <table class = "scrollable_table">
        <tbody>
            <tr>
                <th>Number</th>
                <th>Group</th>
                <th>Assigned To</th>
                <th>Title</th>
                <th>Status</th>
                <th>Created (UTC)</th>
                <th>Modified (UTC)</th>
                <th>Resolved (UTC)</th>
                <th>Time Spent</th>
            </tr>
            {% for case in full_cases_day %}
                <tr>
                    <td>{{ case.case_no }}</td>
                    <td>{{ case.assigned_groupname }}</td>
                    <td>{{ case.assigned_username }}</td>
                    <td>{{ case.title }}</td>
                    <td>{{ case.casestatus }}</td>
                    <td>{{ case.createdtime }}</td>
                    <td>{{ case.modifiedtime }}</td>
                    <td>{{ case.case_resolved }}</td>
                    <td>{{ case.time_spent_hr }}</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<br>
<hr>
<br>

<p>WEEK</p>
<p>{{ date_group_dict.first_of_week }} - {{ date_group_dict.end_of_week }}</p>
<br>
<section class="points">
            <div class = "score_box">
                <span class ="score_name">MODIFIED</span> </br> <span class="score_num">{{ case_stats_dict_week.modified }}</span>
            </div>
            <div class = "score_box">
                <span class ="score_name">CREATED</span> </br> <span class="score_num">{{ case_stats_dict_week.opened }}</span>
            </div>
            <div class = "score_box">
                <span class ="score_name">RESOLVED</span> </br> <span class="score_num">{{ case_stats_dict_week.closed }}</span>
            </div>
            <div class = "score_box">
                <span class ="score_name">KILL RATE</span> </br> <span class="score_num">{{ case_stats_dict_week.kill_rate }}%</span>
            </div>
            <div>
                {% if sorted_user_closed_week|length > 0 %}
                    <table>
                        <tbody>
                            <tr>
                                <th>USER</th>
                                <th>CLOSED CASES</th>
                            </tr>
                            {% for score  in sorted_user_closed_week %}
                                <tr>
                                    <th>{{ score.0 }} </th>
                                    <th>{{ score.1 }} </th>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                {% endif %}
            </div>
</section>

<button onclick="showHideCaseTable('week')">Show/Hide Case Table</button>
<div id = "case_table_week">
    <table class = "scrollable_table">
        <tbody>
            <tr>
                <th>Number</th>
                <th>Group</th>
                <th>Assigned To</th>
                <th>Title</th>
                <th>Status</th>
                <th>Created (UTC)</th>
                <th>Modified (UTC)</th>
                <th>Resolved (UTC)</th>
                <th>Time Spent</th>
            </tr>
            {% for case in full_cases_week %}
                <tr>
                    <td>{{ case.case_no }}</td>
                    <td>{{ case.assigned_groupname }}</td>
                    <td>{{ case.assigned_username }}</td>
                    <td>{{ case.title }}</td>
                    <td>{{ case.casestatus }}</td>
                    <td>{{ case.createdtime }}</td>
                    <td>{{ case.modifiedtime }}</td>
                    <td>{{ case.case_resolved }}</td>
                    <td>{{ case.time_spent_hr }}</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<br>
<hr>
<br>

<p>MONTH</p>
<p>{{ date_group_dict.first_of_month }} - {{ date_group_dict.end_of_month }}</p>
<br>
<section class="points">
            <div class = "score_box">
                <span class ="score_name">MODIFIED</span> </br> <span class="score_num">{{ case_stats_dict_month.modified }}</span>
            </div>
            <div class = "score_box">
                <span class ="score_name">CREATED</span> </br> <span class="score_num">{{ case_stats_dict_month.opened }}</span>
            </div>
            <div class = "score_box">
                <span class ="score_name">RESOLVED</span> </br> <span class="score_num">{{ case_stats_dict_month.closed }}</span>
            </div>
            <div class = "score_box">
                <span class ="score_name">KILL RATE</span> </br> <span class="score_num">{{ case_stats_dict_month.kill_rate }}%</span>
            </div>
            <div>
                {% if sorted_user_closed_month|length > 0 %}
                    <table>
                        <tbody>
                            <tr>
                                <th>USER</th>
                                <th>CLOSED CASES</th>
                            </tr>
                            {% for score  in sorted_user_closed_month %}
                                <tr>
                                    <th>{{ score.0 }} </th>
                                    <th>{{ score.1 }} </th>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                {% endif %}
            </div>
</section>

<button onclick="showHideCaseTable('month')">Show/Hide Case Table</button>
<div id = "case_table_month">
    <table class = "scrollable_table">
        <tbody>
            <tr>
                <th>Number</th>
                <th>Group</th>
                <th>Assigned To</th>
                <th>Title</th>
                <th>Status</th>
                <th>Created (UTC)</th>
                <th>Modified (UTC)</th>
                <th>Resolved (UTC)</th>
                <th>Time Spent</th>
            </tr>
            {% for case in full_cases_month %}
                <tr>
                    <td>{{ case.case_no }}</td>
                    <td>{{ case.assigned_groupname }}</td>
                    <td>{{ case.assigned_username }}</td>
                    <td>{{ case.title }}</td>
                    <td>{{ case.casestatus }}</td>
                    <td>{{ case.createdtime }}</td>
                    <td>{{ case.modifiedtime }}</td>
                    <td>{{ case.case_resolved }}</td>
                    <td>{{ case.time_spent_hr }}</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}