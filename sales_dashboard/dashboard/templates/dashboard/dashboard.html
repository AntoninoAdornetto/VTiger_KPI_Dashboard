{% extends 'dashboard/base.html' %}

{% block form %}
    <button type="submit" id="submit" onclick="save_group_date()">SUBMIT</button>
    </form>
<p>{{ date_dict.today_date }} </p>
{% endblock %}

{% block content %}

        <section class="points">
            {% for user, score in user_total_score.items %}
                    <div class = "score_box">
                        <span class ="score_name">{{ user }}</span> </br> <span class="score_num">{{ score }}</span>
                    </div>
            {% endfor %}
        </section>

        <div class="score_key_and_tables">
            <section class="score_key_and_refresh">
                <div class = "score_key">
                    <p>Score Key</p>
                    <table class="score_key_table">
                        <tr>
                            <th>Demo Scheduled:</th>
                            <td>5</td>
                        </tr>
                        <tr>
                            <th>Demo Given:</th>
                            <td>10</td>
                        </tr>
                        <tr>
                            <th>Quote Sent:</th>
                            <td>0</td>
                        </tr>
                        <tr>
                            <th>Pilot:</th>
                            <td>0</td>
                        </tr>
                        <tr>
                            <th>Needs Analysis:</th>
                            <td>0</td>
                        </tr>
                        <tr>
                            <th>Closed Won:</th>
                            <td>0</td>
                        </tr>
                        <tr>
                            <th>Closed Lost:</th>
                            <td>0</td>
                        </tr>
                        <tr>
                            <th>Phone Calls:</th>
                            <td>1</td>
                        </tr>
                    </table>
                </div>
            </section>

            <section class="score_tables">
                {% for user, value in user_opp_dict.items %}
                    <p class="score_table_title">{{ user }}</p>
                        <table>
                            <th>Demo Scheduled</th>
                            <th>Demo Given</th>
                            <th>Quote Sent</th>
                            <th>Pilot</th>
                            <th>Needs Analysis</th>
                            <th>Closed Won</th>
                            <th>Closed Lost</th>
                            <th>Phone Calls</th>
                            <tr>
                                {% for item, points in value.items %}
                                    <td>
                                        {{ points }}
                                    </td>
                                {% endfor %}
                            </tr>
                        </table>

                    <!--Displays individual opp tables per user.
                    Commenting out because unsure if I want to go this route
                    display wise.
                    {% for username, opps in user_opps.items %}
                        {% if username == user %}
                                <table class="scrollable_table">
                                    <th>Number</th>
                                    <th>Name</th>
                                    <th>Stage</th>
                                    <th>Current Stage Changed</th>
                                    <th>Modified Time</th>
                                    <th>Created Time</th>
                                    {% for opp in opps %}
                                        <tr>
                                            <td>{{ opp.opp_no }}</td>
                                            <td>{{ opp.opp_name }}</td>
                                            <td>{{ opp.opp_stage }}</td>
                                            <td>{{ opp.current_stage_entry_time }}</td>
                                            <td>{{ opp.modifiedtime }}</td>
                                            <td>{{ opp.createdtime }}</td>
                                        </tr>
                                    {% endfor %}
                                </table>
                        {% endif %}
                    {% endfor %}
                    -->
                {% endfor %}
            </section>
        </div> 

        <input type=checkbox id="show_today_opps">
        <label for="show_today_opps" class="show_label">SHOW OPPs</label>

        <input type=checkbox id="show_today_calls">
        <label for="show_today_calls" class="show_label">SHOW CALLs</label>

        <div id = "today_opp_table">
            <table class="scrollable_table">
                <th>#</th>
                <th>Number</th>
                <th>User</th>
                <th>Name</th>
                <th>Stage</th>
                <th>Current Stage Changed</th>
                <th>Modified Time</th>
                <th>Created Time</th>
                {% for opp in today_opps %}
                    <tr>
                        <td>{{ forloop.counter }}</td>
                        <td>{{ opp.opp_no }}</td>
                        <td>{{ opp.assigned_username }}</td>
                        <td>{{ opp.opp_name }}</td>
                        <td>{{ opp.opp_stage }}</td>
                        <td>{{ opp.current_stage_entry_time }}</td>
                        <td>{{ opp.modifiedtime }}</td>
                        <td>{{ opp.createdtime }}</td>
                    </tr>
                {% endfor %}
            </table>
        </div>

        <div id = "today_call_table">
            <table class="scrollable_table">
                <th>#</th>
                <th>User</th>
                <th>Call Time</th>
                <th>End Time</th>
                <th>Status</th>
                <th>Direction</th>
                <th>Duration</th>
                <th>Customer Number</th>
                {% for call in today_phone_calls %}
                    <tr>
                        <td>{{ forloop.counter }}</td>
                        <td>{{ call.assigned_username }}</td>
                        <td>{{ call.modifiedtime }}</td>
                        <td>{{ call.endtime }}</td>
                        <td>{{ call.call_status }}</td>
                        <td>{{ call.direction }}</td>
                        <td>{{ call.total_duration }}</td>
                        <td>{{ call.customer_number }}</td>
                    </tr>
                {% endfor %}
            </table>
        </div>

{% endblock %}